# Migration `20200123054226-init`

This migration has been generated by Thor Anderson at 1/23/2020, 5:42:26 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "public"."Association" (
  "additionalProperties" text    ,
  "associationType" text  NOT NULL DEFAULT 'ExactMatchOf' ,
  "createdAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00' ,
  "entityId" text  NOT NULL DEFAULT '' ,
  "entityType" text  NOT NULL DEFAULT 'Basic' ,
  "id" text  NOT NULL  ,
  "type" text  NOT NULL DEFAULT '' ,
  "updatedAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00' ,
  PRIMARY KEY ("id")
);

CREATE TABLE "public"."Competency" (
  "CFDocumentURI" text    ,
  "additionalProperties" text    ,
  "alternativeLabel" text    ,
  "bloomCategory" text    ,
  "createdAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00' ,
  "defaultCredits" text    ,
  "defaultPoints" text    ,
  "description" text    ,
  "humanCodingScheme" text    ,
  "id" text  NOT NULL  ,
  "name" text  NOT NULL DEFAULT '' ,
  "sourcedId" text    ,
  "type" text  NOT NULL DEFAULT 'Basic' ,
  "updatedAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00' ,
  PRIMARY KEY ("id")
);

CREATE TABLE "public"."Course" (
  "additionalProperties" text    ,
  "alternativeLabel" text    ,
  "courseCode" text  NOT NULL DEFAULT '' ,
  "createdAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00' ,
  "defaultCredits" text  NOT NULL DEFAULT '' ,
  "defaultPoints" text    ,
  "description" text  NOT NULL DEFAULT '' ,
  "endDate" timestamp(3)    ,
  "id" text  NOT NULL  ,
  "name" text  NOT NULL DEFAULT '' ,
  "sourcedId" text    ,
  "startDate" timestamp(3)    ,
  "type" text  NOT NULL DEFAULT 'Course' ,
  "updatedAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00' ,
  PRIMARY KEY ("id")
);

CREATE TABLE "public"."Issuer" (
  "additionalProperties" text    ,
  "address" text    ,
  "createdAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00' ,
  "id" text  NOT NULL  ,
  "issuingPersonFullName" text  NOT NULL DEFAULT '' ,
  "issuingPersonTitle" text  NOT NULL DEFAULT '' ,
  "logo" text    ,
  "name" text  NOT NULL DEFAULT '' ,
  "phone" text    ,
  "type" text  NOT NULL DEFAULT 'Issuer' ,
  "updatedAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00' ,
  "url" text  NOT NULL DEFAULT '' ,
  PRIMARY KEY ("id")
);

CREATE TABLE "public"."Resource" (
  "createdAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00' ,
  "description" text  NOT NULL DEFAULT '' ,
  "id" text  NOT NULL  ,
  "updatedAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00' ,
  "url" text  NOT NULL DEFAULT '' ,
  PRIMARY KEY ("id")
);

CREATE TABLE "public"."Tag" (
  "createdAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00' ,
  "id" text  NOT NULL  ,
  "name" text  NOT NULL DEFAULT '' ,
  "orderWithinCategory" integer  NOT NULL DEFAULT 0 ,
  "updatedAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00' ,
  PRIMARY KEY ("id")
);

CREATE TABLE "public"."ConceptualCategory" (
  "createdAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00' ,
  "description" text  NOT NULL DEFAULT '' ,
  "id" text  NOT NULL  ,
  "name" text  NOT NULL DEFAULT '' ,
  "updatedAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00' ,
  PRIMARY KEY ("id")
);

ALTER TABLE "public"."Association" ADD COLUMN "course" text    REFERENCES "public"."Course"("id") ON DELETE SET NULL;

ALTER TABLE "public"."Competency" ADD COLUMN "associations" text    REFERENCES "public"."Association"("id") ON DELETE SET NULL,
ADD COLUMN "issuer" text  NOT NULL  REFERENCES "public"."Issuer"("id") ON DELETE RESTRICT;

ALTER TABLE "public"."Course" ADD COLUMN "issuer" text  NOT NULL  REFERENCES "public"."Issuer"("id") ON DELETE RESTRICT;

ALTER TABLE "public"."Issuer" ADD COLUMN "competency" text    REFERENCES "public"."Competency"("id") ON DELETE SET NULL,
ADD COLUMN "course" text    REFERENCES "public"."Course"("id") ON DELETE SET NULL,
ADD COLUMN "resource" text    REFERENCES "public"."Resource"("id") ON DELETE SET NULL;

ALTER TABLE "public"."Resource" ADD COLUMN "competency" text    REFERENCES "public"."Competency"("id") ON DELETE SET NULL,
ADD COLUMN "issuer" text  NOT NULL  REFERENCES "public"."Issuer"("id") ON DELETE RESTRICT;

ALTER TABLE "public"."Tag" ADD COLUMN "competency" text    REFERENCES "public"."Competency"("id") ON DELETE SET NULL,
ADD COLUMN "conceptualCategory" text  NOT NULL  REFERENCES "public"."ConceptualCategory"("id") ON DELETE RESTRICT,
ADD COLUMN "issuer" text  NOT NULL  REFERENCES "public"."Issuer"("id") ON DELETE RESTRICT,
ADD COLUMN "resource" text    REFERENCES "public"."Resource"("id") ON DELETE SET NULL;

ALTER TABLE "public"."ConceptualCategory" ADD COLUMN "issuer" text  NOT NULL  REFERENCES "public"."Issuer"("id") ON DELETE RESTRICT;

CREATE UNIQUE INDEX "Issuer.url" ON "public"."Issuer"("url")
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20200123054226-init
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,145 @@
+datasource postgres {
+  provider = "postgresql"
+  url      = "postgresql://postgres:docker@localhost:5432/pg-comp-model?schema=public"
+}
+
+generator photon {
+  provider = "photonjs"
+}
+
+enum AssociationType {
+    ExactMatchOf
+    Precedes
+    IsChildOf
+    IsParentOf
+    HasSkillLevel
+    ReplacedBy
+    IsPartOf
+    Exemplar
+    IsRelatedTo
+    IsPeerOf
+}
+
+enum EntityType {
+    Basic
+    Competency
+    Course
+    Degree
+    Certificate
+    Assessment
+    CoCurricular
+}
+
+enum BloomLevel {
+  CREATE
+  EVALUATE
+  ANALYZE
+  APPLY
+  UNDERSTAND
+  REMEMBER
+  INFO
+}
+
+model Association {
+    id        String   @default(cuid()) @id
+    createdAt DateTime @default(now())
+    updatedAt DateTime @updatedAt
+    type String
+    associationType AssociationType
+    entityType EntityType
+    entityId String
+    additionalProperties String?
+}
+
+model Competency {
+    id        String   @default(cuid()) @id
+    createdAt DateTime @default(now())
+    updatedAt DateTime @updatedAt
+    type EntityType
+    name String
+    description String?
+    defaultCredits String?
+    defaultPoints String?
+    sourcedId String?
+    associations Association?
+    alternativeLabel String?
+    additionalProperties String?
+    humanCodingScheme String?
+    CFDocumentURI String?
+    bloomCategory BloomLevel?
+    resources Resource[]
+    tags Tag[]
+    issuer Issuer @relation(name: "CompetencyIssuer")
+    endorsements Issuer[] @relation(name: "CompetencyEndorsements")
+}
+
+model Course {
+  id        String   @default(cuid()) @id
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+  type EntityType @default(Course)
+    name String
+    description String
+    defaultCredits String
+    defaultPoints String?
+    sourcedId String?
+    associations Association[]
+    alternativeLabel String?
+    additionalProperties String?
+    courseCode String
+    startDate DateTime?
+    endDate DateTime?
+    issuer Issuer @relation(name: "CourseIssuer")
+    endorsements Issuer[] @relation(name: "CourseEndorsements")
+}
+
+model Issuer {
+  id        String   @default(cuid()) @id
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+    type String @default(value: "Issuer") 
+    name String
+    url String @unique
+    address String?
+    phone String?
+    logo String?
+    issuingPersonFullName String
+    issuingPersonTitle String
+    additionalProperties String?
+}
+
+model Resource {
+  id        String   @default(cuid()) @id
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+  description String
+  url String
+  tags Tag[]
+  issuer Issuer @relation(name: "ResourceIssuer")
+  endorsements Issuer[] @relation(name: "ResourceEndorsements")
+}
+
+model Tag {
+  id        String   @default(cuid()) @id
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+  issuer Issuer
+  name String
+  conceptualCategory ConceptualCategory
+  orderWithinCategory Int
+}
+
+model ConceptualCategory {
+  id        String   @default(cuid()) @id
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+  issuer Issuer
+  name String
+  description String
+}
+
+
+
+
+
+
```


